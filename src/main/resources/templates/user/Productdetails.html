<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Product Details</title>
  <meta name="_csrf" th:content="${_csrf.token}" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link href='https://fonts.googleapis.com/css?family=Italianno' rel='stylesheet'>
  <link rel="stylesheet" type="text/css" href="/css/admin/dashboard.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://unpkg.com/js-image-zoom@0.4.1/js-image-zoom.js" type="application/javascript"></script>
  <!-- css -->
  <link rel="stylesheet" th:href="@{/user/home/assets/style.css}" type="text/css">

  <!-- Asom font -->

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
  <link rel="stylesheet" href="https://cdn.rawgit.com/elevateweb/elevatezoom/master/css/jquery.elevatezoom.css" />
</head>

<body>

<header th:replace="fragments/navbar :: header-nav"></header>

<!-- content-->
<section class="py-5">
  <div class="container">
    <div class="row gx-5">
      <aside class="col-lg-6">
        <div class="border rounded-4 mb-3 d-flex justify-content-center">
          <a data-fslightbox="mygalley" class="rounded-4" target="_blank" data-type="image" >
            <img  width="500px" height="500px" style="max-width: 100%; max-height: 100vh; margin: auto;" class="rounded-4 fit item-thumb" th:src="@{'/uploads/'+${product.imagesPath[0]}}" />
          </a>
        </div>
        <div class="d-flex justify-content-center mb-3">
          <a data-fslightbox="mygalley" class="border mx-1 rounded-2" target="_blank" data-type="image" >
            <img width="60" height="60" class="rounded-2 item-thumb" th:src="@{'/uploads/'+${product.imagesPath[0]}}" />
          </a>
          <a data-fslightbox="mygalley" class="border mx-1 rounded-2" target="_blank" data-type="image" >
            <img width="60" height="60" class="rounded-2 item-thumb" th:src="@{'/uploads/'+${product.imagesPath[1]}}" />
          </a>
          <a data-fslightbox="mygalley" class="border mx-1 rounded-2 " target="_blank" data-type="image" >
            <img width="60" height="60" class="rounded-2 item-thumb" th:src="@{'/uploads/'+${product.imagesPath[2]}}" />
          </a>





        </div>
        <!-- thumbs-wrap.// -->
        <!-- gallery-wrap .end// -->
      </aside>
      <main class="col-lg-6">
        <div class="ps-lg-3">
          <h4 class="title text-dark">
           <span th:text="${product.productName}"></span>
          </h4>
          <div class="d-flex flex-row my-3">
            <div class="text-warning mb-1 me-2">
              <i class="fa fa-star"></i>
              <i class="fa fa-star"></i>
              <i class="fa fa-star"></i>
              <i class="fa fa-star"></i>
              <i class="fas fa-star-half-alt"></i>
              <span class="ms-1">
                          4.5
                        </span>
            </div>

            <span class="text-success ms-2">In stock</span>
          </div>



          <p>
            <span th:text="${product.description}"></span>
          </p>

          <div class="row">
            <dt class="col-3">Category:</dt>
            <dd th:text="${product.category.categoryName}" class="col-9"></dd>

            <dt class="col-3">Brand</dt>
            <dd th:text="${product.brand.brandName}" class="col-9"></dd>
            <input type="hidden" id="productId" th:value="${product.productID}" />

<!--            <dt class="col-3">RAM</dt>-->
<!--            <dd class="col-9"></dd>-->

<!--            <dt class="col-3">STORAGE</dt>-->
<!--            <dd class="col-9">Reebook</dd>-->
          </div>

          <hr />

<!--          <div class="row mb-4">-->
<!--            <div class="col-md-4 col-6">-->
<!--              <label class="mb-2">Size</label>-->
<!--              <select class="form-select border border-secondary" style="height: 35px;">-->
<!--                <option>Small</option>-->
<!--                <option>Medium</option>-->
<!--                <option>Large</option>-->
<!--              </select>-->
<!--            </div>-->
            <!-- col.// -->
<!--            <div class="col-md-4 col-6 mb-3">-->
<!--              <label class="mb-2 d-block">Quantity</label>-->
<!--              <div class="input-group mb-3" style="width: 170px;">-->
<!--                <button class="btn btn-white border border-secondary px-3" type="button" id="button-addon1" data-mdb-ripple-color="dark">-->
<!--                  <i class="fas fa-minus"></i>-->
<!--                </button>-->
<!--                <input type="text" class="form-control text-center border border-secondary" placeholder="14" aria-label="Example text with button addon" aria-describedby="button-addon1" />-->
<!--                <button class="btn btn-white border border-secondary px-3" type="button" id="button-addon2" data-mdb-ripple-color="dark">-->
<!--                  <i class="fas fa-plus"></i>-->
<!--                </button>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->

          <!-- Add MRP and Discount Price to your product details section -->
          <div class="row">
            <dt class="col-3">MRP:</dt>
            <dd class="col-9">
              <del>₹<span th:text="${product.price + product.productDiscountAmout + product.categoryOffer.discountAmount}"></span></del>
            </dd>

            <dt class="col-3">Discount Price:</dt>
            <dd class="col-9" >₹<span th:text="${product.price}"></span></dd>
          </div>


          <a href="" class="btn btn-warning shadow-0"> Buy now </a>
          <button onclick="addtocart()" class="btn btn-primary shadow-0" > <i class="me-1 fa fa-shopping-basket"></i> Add to cart </button>
          <a href="#" class="btn btn-light border border-secondary py-2 icon-hover px-3"> <i class="me-1 fa fa-heart fa-lg"></i> Save </a>
        </div>
      </main>
    </div>
  </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous">
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
        integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous">
</script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script src="https://cdn.rawgit.com/elevateweb/elevatezoom/master/jquery.elevatezoom.js"></script>



<!-- Uncomment the script section for image change -->
<script>
  $(document).ready(function () {
    $(".item-thumb").click(function () {
      var newImageSrc = $(this).attr("src");
      $(".fit").attr("src", newImageSrc);
    });
  });
</script>
<script>
  $(document).ready(function () {
    $(".item-thumb").click(function () {
      var newImageSrc = $(this).attr("src");
      $(".fit").attr("src", newImageSrc).elevateZoom();
    });
  });
</script>

<script>
  function addtocart() {
    // Fetch URL for your server endpoint to handle the cart addition
    const addToCartURL = '/user/cart/add-to-cart';
    const productId = document.getElementById('productId').value;

    // Create FormData and append the product ID
    const formData = new FormData();
    formData.append("productId", productId);

    // Example: Sending a POST request with FormData
    fetch(addToCartURL, {
      method: 'POST',
      headers: {
        'X-CSRF-TOKEN': getCsrfToken(),
      },
      body: formData
    })
            .then(res => {
              if (res.ok) {
                console.log("Added to cart successfully");
                // Show a success message using Swal
                Swal.fire({
                  icon: 'success',
                  title: 'Product added to cart successfully',
                  showConfirmButton: false,
                  timer: 2000
                });
                window.location.reload();
              } else {
                console.error("Failed to add to cart");
                // Show an error message using Swal
                Swal.fire({
                  icon: 'error',
                  title: 'Error adding product to cart',
                  text: 'Please try again later.'
                });
              }
            })
            .catch(err => {
              console.error('Error adding to cart:', err);
              // Show a generic error message using Swal
              Swal.fire({
                icon: 'error',
                title: 'Something went wrong',
                text: 'Please try again later.'
              });
            });
  }

  function getCsrfToken() {
    return document.querySelector('meta[name="_csrf"]').content;
  }
</script>


</body>


</html>